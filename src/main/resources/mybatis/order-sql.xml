<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="dao.OrderDao">
    <select id="orderList" parameterType="java.util.Map" resultType="entity.Order">
        select id,order_num as orderNum,wangwang,address,reality_pay as realityPay,create_time as createTime from orderinfo where 1=1
        <if test="query!=null and type=='search'">
            and ((order_num like concat('%',#{query},'%')) or(wangwang like concat('%',#{query},'%')))
        </if>
        <if test="query!=null and type=='condition'">
           and ${query}
        </if>
        order by create_time desc limit #{limit},#{offset}
    </select>

    <select id="allOrders" resultType="int" parameterType="string">
        select count(1) from orderinfo where 1=1
        <if test="query!=null and type=='search'">
            and ((order_num like concat('%',#{query},'%')) or(wangwang like concat('%',#{query},'%')))
        </if>
        <if test="query!=null and type=='condition'">
           and ${query}
        </if>
    </select>

    <select id="isExist" parameterType="string" resultType="int">
        select count(1) from orderinfo where order_num=#{_parameter}
    </select>

    <update id="updateOrder" parameterType="entity.Order">
        update orderinfo set order_num =#{orderNum},wangwang=#{wangwang},address=#{address},reality_pay=#{realityPay},create_time=#{createTime} where id=#{id}
    </update>
</mapper>